#!/usr/bin/env bash
set -e

if type git; then
  : # You have git command. No Problem
else
  echo "Please install git command!"
  exit 1;
fi

if [ ! -n "$DOTFILES_DIR" ]; then
  DOTFILES_DIR="${HOME}/.dotfiles"
fi

echo ""
echo "Start fetch dotfiles..."

if [ ! -d "${DOTFILES_DIR}" ]; then
  mkdir -p "${DOTFILES_DIR}"
  git clone git@github.com:ryog/dotfiles.git "${DOTFILES_DIR}"
else
  echo "TODO: Add comment"
fi

echo "Done."
echo ""
echo "Start symbolic link dotfiles..."

[ ! -d "${HOME}/.config" ] && mkdir -p "${HOME}/config"
[ ! -d "${HOME}/.vim" ] && mkdir -p "${HOME}/.vim"

file_names=(
  bash_aliases
  bash_profile
  bashrc
  ctags
  gemrc
  gitconfig
  gitignore
  railsrc
  rubocop.yml
  tmux.conf
  vimrc
  vim/neobundle.toml
  vim/neobundlelazy.toml
  vim/plugins.rc.vim
)

for file_name in ${file_names[@]}; do
  ln -vsf "${DOTFILES_DIR}/${file_name}" "${HOME}/.${file_name}"
done

ln -vsf "${DOTFILES_DIR}/vim" "${HOME}/.config/nvim"
ln -vsf "${DOTFILES_DIR}/vimrc" "${HOME}/.config/nvim/init.vim"

echo "Done."
echo ""
echo "Start install NeoBundle"

if [ ! -d "${HOME}/.vim/bundle/neobundle.vim" ]; then
  curl https://raw.githubusercontent.com/Shougo/neobundle.vim/master/bin/install.sh | sh
else
  echo "TODO: Add comment"
fi

echo "Done."
echo ""
echo "Complete setup dotfiles!"
